《基于 KesPlus 的高校选课管理系统》项目报告模板（按现状已对齐）
================================================

说明：本项目为“数据库 + Web 应用系统”，包含数据库脚本（表/触发器/过程/函数）、Express API、静态前端页面（HTML/JS），并要求补充 KesPlus 平台页面/数据源与导出包。
建议最终提交 PDF/Word 时按本模板补齐：ER 图、关键页面截图、KesPlus 导出证明、测试与验收记录。

一、系统概述
1.1 系统简介
- 项目名称：基于 KesPlus 的高校选课管理系统
- 目标：学生选课/退课与课表，教师查看授课与选课统计，管理员维护基础数据并查看统计分析。
- 技术栈与资产对应：
  - 数据库：`db/*.sql`（表结构、触发器、过程/函数、种子数据）
  - 后端：`server/index.js`（Express API）+ `server/db.js`（连接池）
  - 前端：`web/index.html`（登录）+ `web/student.html`/`web/teacher.html`/`web/admin.html` + `web/vue-dashboard.html`
  - 测试：`tests/db_trigger_procedure_tests.sql`（事务内回归测试，结束回滚）
  - 交付：KesPlus 导出包放 `deliverables/kesplus_export/`；数据库逻辑备份放 `backups/`

1.2 功能特色（写“能演示”的点）
- 角色分流：管理员/教师/学生登录后按角色跳转页面（见 `docs/login-role-plan.md`）。
- 核心交易：选课/退课由存储过程控制，触发器维护人数与一致性。
- 课程容量控制：满员提示，支持候补队列自动补位（若已实现则截图）。
- 时间冲突检测：选课前冲突检查 + 学生课表生成（若已实现则截图）。
- 数据统计与可视化：TopN、学院分布、选课趋势；支持 CSV 导出（若已实现则截图）。

二、需求分析
2.1 系统功能需求分析（按角色写“用例”）
- 学生：登录、查询可选课程、选课、退课、查看我的课程、查看课表、查看候补状态。
- 教师：登录、查看授课课程、查看每门课选课人数/名单、查看统计图表。
- 管理员：登录、维护学院/专业/教师/学生/课程、配置学期与时间窗口、查看统计与导出。

2.2 数据库需求分析
- 数据实体：用户、学生、教师、学院、专业、课程、选课记录、系统参数（以及可选的课程时间片/候补队列）。
- 约束：唯一性、外键关系、课程容量、选课窗口/退课窗口、角色状态与禁用。
- 非功能：并发一致性（选课不超卖）、可审计（选/退课时间）、安全（密码哈希、权限控制）。

三、数据库设计
3.1 概念模式设计（ER 图）
- 在报告中给出 ER 图，并标注主键/外键与基数关系（1:N、N:M）。

3.2 逻辑模式设计（表结构与字段字典）
- 逐表说明：字段含义、类型、约束（NOT NULL/UNIQUE/CHECK/FOREIGN KEY）。
- 建议把核心表写全：TB_USER、TB_STUDENT、TB_TEACHER、TB_COURSE、TB_STUDENT_COURSE、TB_SYS_PARAM。

3.3 物理数据库设计（索引与性能）
- 列出主要索引与原因（学号/课程号/学期/选课记录查询等）。
- 说明高频查询与优化策略（视图/函数、必要的索引）。

3.4 触发器设计
- 说明触发器用途：维护选课人数、回收人数、数据一致性校验等。
- 对应脚本：`db/02_triggers_course_selection.sql`

3.5 存储过程/函数设计
- 登录：`FN_LOGIN`（返回 user_id/role/stu_id/tea_id 等）
- 交易：`PROC_SELECT_COURSE`、`PROC_DROP_COURSE`（以及包装函数 `FN_SELECT_COURSE`/`FN_DROP_COURSE`）
- 统计：`PROC_STAT_COURSE_SELECT` 及扩展统计函数（如 TopN/趋势等）
- 若实现候补/冲突检测：补充相关函数与过程说明
- 对应脚本：`db/03_procedures_course_selection.sql`

四、系统设计与实现
4.1 模块与页面统计表（替代“窗体类”）
- 后端模块：登录鉴权、课程查询、选课/退课、统计、导出、配置读取。
- 前端页面：登录页、学生页、教师页、管理员页、统计大屏（Vue）。
- KesPlus 平台页面：至少 5 个（除登录外），建议 8+，并给出菜单截图与页面截图。

4.2 界面设计与代码实现（建议“截图 + 关键代码/SQL”）
- 登录与角色分流：页面截图 + `/api/login` 返回字段与 token 使用说明。
- 学生端：可选课程、我的选课、冲突提示、课表、候补（每个点给截图）。
- 教师/管理员端：课程/统计/导出（每个点给截图）。
- 数据源调用：KesPlus 数据源（SQL/过程/HTTP）配置截图，说明参数绑定方式。

五、系统测试
5.1 触发器测试用例
- 使用 `tests/db_trigger_procedure_tests.sql` 中的 T* 用例，贴执行截图/输出摘要。

5.2 存储过程/函数测试用例
- 使用 `tests/db_trigger_procedure_tests.sql` 中的 L*/P*/D*/S* 用例，贴执行截图/输出摘要。

5.3 功能测试用例（端到端）
- 以三角色账号走通主流程（登录 → 查询 → 操作 → 结果可见）。
- 建议同时给出 curl/接口测试记录（见 `docs/TESTING.md`）。

六、总结
- 完成情况：已实现的功能点列表 + 未完成/待优化项（KesPlus 导出、更多页面、报表完善等）。
- 创新点与实用性：冲突检测/课表/候补/可视化/导出等（选择已落地的写）。
- 后续改进：权限细化、并发性能、审计与安全加固、页面体验优化等。
